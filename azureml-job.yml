$schema: https://azuremlschemas.azureedge.net/latest/commandJob.schema.json
name: facade-defect-detection
display_name: Facade Defect Detection
description: Command job for detecting defects in facade images using AI models

# Command job inputs
inputs:
  batch_id:
    type: string
  input_dataset:
    type: uri_folder
  model:
    type: mlflow_model

# Required parameters for CommandJob schema
command: >-
  python src/component.py 
  --batch_id ${{inputs.batch_id}} 
  --input_ds ${{inputs.input_dataset}} 
  --model ${{inputs.model}}
  --window_size 512
  --overlap 64
  --confidence 50
  --mode auto
  --local False
  --output_dir outputs

# Define compute for the job
compute: azureml:cpu-cluster2
resources:
  instance_count: 1

# Required environment specification
environment: 
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu20.04
  conda_file: ./environment.yml

# Output directories
outputs:
  job_output:
    type: uri_folder